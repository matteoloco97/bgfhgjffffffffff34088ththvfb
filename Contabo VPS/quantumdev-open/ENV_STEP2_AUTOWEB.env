# ============================================================================
# STEP 2 - Autoweb Deep Retry & Fallback Environment Variables
# ============================================================================
# Add these to your existing .env file to enable STEP 2 features

# -----------------------------------------------------------------------------
# Autoweb Deep Retry Configuration
# -----------------------------------------------------------------------------
# Minimum number of "good" results required before skipping deep retry
# If search returns fewer than this many results, attempt a relaxed second search
WEB_DEEP_MIN_RESULTS=3

# Maximum number of deep retry attempts (usually 1 is enough)
WEB_DEEP_MAX_RETRIES=1

# Enable fallback to internal LLM when web search completely fails
# When enabled (1), the system will use LLM knowledge if no web results found
# When disabled (0), returns "no results found" message
WEB_FALLBACK_TO_LLM=1

# -----------------------------------------------------------------------------
# How it works:
# -----------------------------------------------------------------------------
# 1. Initial web search executes with user's original query
# 2. If results < WEB_DEEP_MIN_RESULTS AND WEB_DEEP_MAX_RETRIES > 0:
#    - Query is "relaxed" by removing temporal words (oggi, adesso, ultime, etc.)
#    - Second search executes with relaxed query
#    - Results are deduplicated and merged
# 3. If still no useful results AND WEB_FALLBACK_TO_LLM=1:
#    - System falls back to LLM internal knowledge
#    - Response explains that web search failed
#    - Provides best-effort answer from training data
#
# Examples of query relaxation:
#   "meteo roma oggi"           → "meteo roma"
#   "ultime notizie bitcoin"    → "notizie bitcoin"
#   "prezzo btc adesso"         → "prezzo btc"
#   "novità mercato aerospaziale" → "mercato aerospaziale"

# -----------------------------------------------------------------------------
# Recommended Settings
# -----------------------------------------------------------------------------
# Development/Testing:
#   WEB_DEEP_MIN_RESULTS=3
#   WEB_DEEP_MAX_RETRIES=1
#   WEB_FALLBACK_TO_LLM=1
#
# Production (conservative):
#   WEB_DEEP_MIN_RESULTS=2
#   WEB_DEEP_MAX_RETRIES=1
#   WEB_FALLBACK_TO_LLM=1
#
# Production (aggressive, more fallbacks):
#   WEB_DEEP_MIN_RESULTS=4
#   WEB_DEEP_MAX_RETRIES=1
#   WEB_FALLBACK_TO_LLM=1

# -----------------------------------------------------------------------------
# Integration with Existing Settings
# -----------------------------------------------------------------------------
# These work together with existing deep mode settings:
#   WEB_SEARCH_DEEP_MODE=0      # Manual deep mode (explicit user request)
#   WEB_DEEP_MAX_SOURCES=15     # Max sources for deep mode
#
# The new automatic retry (WEB_DEEP_MIN_RESULTS) is independent and always
# active when conditions are met, regardless of WEB_SEARCH_DEEP_MODE setting.
